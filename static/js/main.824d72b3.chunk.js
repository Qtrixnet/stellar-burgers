(this["webpackJsonpreact-burger"]=this["webpackJsonpreact-burger"]||[]).push([[0],{12:function(e,t,n){e.exports={main_container:"burger-ingredients_main_container__1ypSr",list:"burger-ingredients_list__28pax",ingredients_container:"burger-ingredients_ingredients_container__V2yiM",image:"burger-ingredients_image__1Vkgr",list_item:"burger-ingredients_list_item__1YsBs",price_info:"burger-ingredients_price_info__3qybk",text:"burger-ingredients_text__25ymS"}},13:function(e,t,n){e.exports={header:"app-header_header__2Najp",headerContainer:"app-header_headerContainer__sH8CK",profile:"app-header_profile__46wYZ",logo:"app-header_logo__2b8ll",link:"app-header_link__1v2QL",link_active:"app-header_link_active__m5wx3",list:"app-header_list__NmE0n"}},167:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),r=n(20),i=n.n(r),s=n(4),o=n(73),l=n.n(o),d=n(22),u=n(6),_=n(13),p=n.n(_),j=n(1);var b=function(){return Object(j.jsx)("header",{className:"".concat(p.a.header," text text_type_main-default pt-4 pb-4"),children:Object(j.jsxs)("div",{className:p.a.headerContainer,children:[Object(j.jsx)("nav",{children:Object(j.jsxs)("ul",{className:p.a.list,children:[Object(j.jsx)("li",{children:Object(j.jsxs)(d.c,{className:"pt-5 pr-5 pb-5 ".concat(p.a.link_active," ").concat(p.a.link),to:"/",children:[Object(j.jsx)(u.BurgerIcon,{type:"primary"}),Object(j.jsx)("span",{className:"ml-2",children:"\u041a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0442\u043e\u0440"})]})}),Object(j.jsx)("li",{children:Object(j.jsxs)(d.c,{className:"p-5 ".concat(p.a.link),to:"/",children:[Object(j.jsx)(u.ListIcon,{type:"secondary"}),Object(j.jsx)("span",{className:"ml-2",children:"\u041b\u0435\u043d\u0442\u0430 \u0437\u0430\u043a\u0430\u0437\u043e\u0432"})]})})]})}),Object(j.jsx)("div",{className:p.a.logo,children:Object(j.jsx)(u.Logo,{})}),Object(j.jsxs)(d.b,{className:"p-5 ".concat(p.a.link," ").concat(p.a.profile),to:"/",children:[Object(j.jsx)(u.ProfileIcon,{type:"secondary"}),Object(j.jsx)("span",{className:"ml-2",children:"\u041b\u0438\u0447\u043d\u044b\u0439 \u043a\u0430\u0431\u0438\u043d\u0435\u0442"})]})]})})},O=n(26),m=n(2),x=n(11),h=n(12),E=n.n(h),f=function(e){var t=e.getBoundingClientRect();return{top:Math.round(t.top+scrollY),left:Math.round(t.left+scrollX)}};function y(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.ingredientsData.ingredients})),n=Object(s.c)((function(e){return e.ingredientsData.chosenIngredients})),a=Object(c.useState)("bun"),r=Object(x.a)(a,2),i=r[0],o=r[1],l=Object(c.useState)(!1),d=Object(x.a)(l,2),_=d[0],p=d[1],b=Object(c.useState)({}),h=Object(x.a)(b,2),y=h[0],g=h[1],N=Object(c.useState)({}),D=Object(x.a)(N,2),v=D[0],T=D[1],I=Object(c.useRef)();Object(c.useEffect)((function(){I.current&&(I.current.style.transform="translate(".concat(v.x,"px, ").concat(v.y,"px)"))}),[v]);var R=function(e){p(!0),g(Object(m.a)(Object(m.a)({},y),{},{x:e.clientX-e.currentTarget.getBoundingClientRect().left,y:e.clientY-e.currentTarget.getBoundingClientRect().top}))},S=function(e){_&&(e.stopPropagation(),e.preventDefault(),T(Object(m.a)(Object(m.a)({},v),{},{x:e.clientX-y.x,y:e.clientY-y.y})))},C=function(){p(!1)},A=function(e){o(e),document.querySelector("#".concat(e)).scrollIntoView({block:"start",behavior:"smooth"})},P=function(n){n.preventDefault();var c=n.currentTarget.dataset.id,a=t.find((function(e){return e._id===c}));e({type:"SELECT_INGREDIENT",payload:a}),e({type:"CHANGE_INGREDIENTS_POPUP_STATE",payload:!0})},G=function(c){var a=t.find((function(e){return e._id===c.currentTarget.dataset.id})),r=n.find((function(e){return"bun"===e.type})),i=n.indexOf(r);if("bun"===a.type&&r){var s=n.slice();s.splice(i,1,a),e({type:"ADD_INGREDIENT",payload:Object(O.a)(s)})}else e({type:"ADD_INGREDIENT",payload:[].concat(Object(O.a)(n),[a])})},L=function(e){var t=e.image,c=e.price,a=e.name,r=e._id,i=0;return n.forEach((function(e){return e.name===a&&("bun"===e.type?i+=2:i+=1)})),Object(j.jsxs)("li",{"data-id":r,ref:I,onMouseMove:S,onMouseDown:R,onMouseUp:C,onClick:G,onContextMenu:P,className:E.a.list_item,children:[Object(j.jsx)("img",{alt:a,src:t,className:"".concat(E.a.image," ml-4 mr-4")}),Object(j.jsxs)("div",{className:"".concat(E.a.price_info," mt-4 mb-4"),children:[Object(j.jsx)("span",{className:"text text_type_digits-default mr-2",children:c}),Object(j.jsx)(u.CurrencyIcon,{type:"primary"})]}),Object(j.jsx)("h3",{className:"".concat(E.a.text," text text_type_main-default"),children:a}),Object(j.jsx)(u.Counter,{count:i,size:"default"})]},r)};return Object(j.jsxs)("div",{className:E.a.main_container,children:[Object(j.jsx)("h1",{className:"mt-10 mb-5 text text_type_main-large",children:"\u0421\u043e\u0431\u0435\u0440\u0438\u0442\u0435 \u0431\u0443\u0440\u0433\u0435\u0440"}),Object(j.jsxs)("div",{style:{display:"flex"},children:[Object(j.jsx)(u.Tab,{value:"bun",active:"bun"===i,onClick:A,children:"\u0411\u0443\u043b\u043a\u0438"}),Object(j.jsx)(u.Tab,{value:"sauce",active:"sauce"===i,onClick:A,children:"\u0421\u043e\u0443\u0441\u044b"}),Object(j.jsx)(u.Tab,{value:"main",active:"main"===i,onClick:A,children:"\u041d\u0430\u0447\u0438\u043d\u043a\u0438"})]}),Object(j.jsxs)("div",{onScroll:function(e){e.target.addEventListener("scroll",(function(){o(function(e){var t=f(document.querySelector("#bun")).top,n=f(document.querySelector("#sauce")).top,c=f(document.querySelector("#main")).top,a=f(document.querySelector(".".concat(e))).top,r=[{title:"bun",value:Math.abs(a-t)},{title:"sauce",value:Math.abs(a-n)},{title:"main",value:Math.abs(a-c)}],i=r.map((function(e){return e.value})),s=Math.min.apply(Math,Object(O.a)(i));return r.find((function(e){return e.value===s})).title}(E.a.main_container))}))},className:"".concat(E.a.ingredients_container," mt-10 ingredients-container"),children:[Object(j.jsx)("h2",{id:"bun",className:"mb-6 text text_type_main-medium",children:"\u0411\u0443\u043b\u043a\u0438"}),Object(j.jsx)("ul",{className:"".concat(E.a.list," pt-6 pb-10 pr-4 pl-4"),children:t.map((function(e){return"bun"===e.type&&L(e)}))}),Object(j.jsx)("h2",{id:"sauce",className:"mb-6 text text_type_main-medium",children:"\u0421\u043e\u0443\u0441\u044b"}),Object(j.jsx)("ul",{className:"".concat(E.a.list," pt-6 pb-10 pr-4 pl-4"),children:t.map((function(e){return"sauce"===e.type&&L(e)}))}),Object(j.jsx)("h2",{id:"main",className:"mb-6 text text_type_main-medium",children:"\u041d\u0430\u0447\u0438\u043d\u043a\u0438"}),Object(j.jsx)("ul",{className:"".concat(E.a.list," pt-6 pb-10 pr-4 pl-4"),children:t.map((function(e){return"main"===e.type&&L(e)}))})]})]})}var g=n(24),N=n.n(g),D=n(74),v=n(75),T=new(function(){function e(t){Object(D.a)(this,e),this._baseUrl=t}return Object(v.a)(e,[{key:"_requestResult",value:function(e){return e.ok?e.json():Promise.reject("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a: \u041e\u0448\u0438\u0431\u043a\u0430 ".concat(e.status," - ").concat(e.statusText))}},{key:"getIngredients",value:function(){var e=this;return fetch("".concat(this._baseUrl,"/ingredients")).then((function(t){return e._requestResult(t)}))}},{key:"sendIngredients",value:function(e){var t=this,n={ingredients:e};return fetch("".concat(this._baseUrl,"/orders"),{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(n)}).then((function(e){return t._requestResult(e)}))}}]),e}())("https://norma.nomoreparties.space/api"),I="GET_ORDER_DATA",R="GET_ORDER_DATA_FAILED",S="GET_ORDER_DATA_SUCCESS",C="DELETE_ORDER_DATA";function A(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.ingredientsData.chosenIngredients})),n=Object(c.useMemo)((function(){return t.reduce((function(e,t){return"bun"===t.type?e+2*t.price:e+t.price}),0)}),[t]),a=function(e,t,n,c){return e.find((function(e){return"bun"===e.type}))?"".concat(e.find((function(e){return"bun"===e.type}))[t]," ").concat(n):c};return Object(j.jsxs)("div",{className:"".concat(N.a.constructor_container," pt-25"),children:[Object(j.jsx)("div",{className:"".concat(N.a.constructor_element," pr-6"),children:t.length>0?Object(j.jsx)(u.ConstructorElement,{type:"top",isLocked:!0,text:a(t,"name","(\u0432\u0435\u0440\u0445)","\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0431\u0443\u043b\u043a\u0443"),price:a(t,"price","","0"),thumbnail:a(t,"image","","")}):Object(j.jsx)("p",{className:"text text_type_main-medium pt-8 pb-15",children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0431\u0443\u043b\u043a\u0443"})}),Object(j.jsx)("ul",{className:"".concat(N.a.list," pl-4 pr-4"),children:t.map((function(n,c){return"bun"!==n.type&&Object(j.jsxs)("li",{className:N.a.list_item,children:[Object(j.jsx)(u.DragIcon,{}),Object(j.jsx)(u.ConstructorElement,{text:n.name,price:n.price,thumbnail:n.image,handleClose:(a=n,function(n){var c=t.indexOf(a),r=t.slice();r.splice(c,1),e({type:"DELETE_INGREDIENT",payload:r})})})]},"".concat(n._id).concat(c));var a}))}),Object(j.jsx)("div",{className:"pr-6",children:t.length>0&&Object(j.jsx)(u.ConstructorElement,{type:"bottom",isLocked:!0,text:a(t,"name","(\u043d\u0438\u0437)","\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0431\u0443\u043b\u043a\u0443"),price:a(t,"price","","0"),thumbnail:a(t,"image","","")})}),Object(j.jsxs)("div",{className:"".concat(N.a.button_container," pt-6 pr-6"),children:[Object(j.jsxs)("div",{className:"mr-10",children:[Object(j.jsx)("span",{className:"text text_type_digits-medium mr-2",children:n}),Object(j.jsx)(u.CurrencyIcon,{type:"primary"})]}),Object(j.jsx)(u.Button,{disabled:!(t.length>0),onClick:function(){var n=t.map((function(e){return e._id}));e(function(e){return function(t){t({type:I}),T.sendIngredients(e).then((function(e){e&&t({type:S,payload:e})})).catch((function(e){return t({type:R})}))}}(n)),e({type:"CHANGE_ORDER_DETAILS_POPUP_STATE",payload:!0})},className:"pt-10",type:"primary",size:"medium",children:"\u041e\u0444\u043e\u0440\u043c\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437"})]})]})}var P=n(51),G=n.n(P);function L(){return Object(j.jsx)("main",{className:G.a.main,children:Object(j.jsxs)("section",{className:G.a.main_container,children:[Object(j.jsx)(y,{}),Object(j.jsx)(A,{})]})})}var k=n(31),q=n.n(k),U=n.p+"static/media/done.cc5a59a7.gif";function w(){var e=Object(s.c)((function(e){return e.orderData.orderDetails}));return Object(j.jsxs)("div",{className:"".concat(q.a.container),children:[Object(j.jsx)("h3",{className:"text text_type_digits-large pt-10 ".concat(q.a.title),children:e.order.number}),Object(j.jsx)("p",{className:"text text_type_main-medium pt-8 pb-15",children:"\u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 \u0437\u0430\u043a\u0430\u0437\u0430"}),Object(j.jsx)("img",{className:"pb-15",src:U,alt:"\u0447\u0435\u043a\u0430\u0443\u0442"}),Object(j.jsx)("p",{className:"text text_type_main-default pb-2 ".concat(q.a.text),children:e.success?"\u0412\u0430\u0448 '".concat(e.name,"' \u043d\u0430\u0447\u0430\u043b\u0438 \u0433\u043e\u0442\u043e\u0432\u0438\u0442\u044c"):"\u0412\u0430\u0448 \u0437\u0430\u043a\u0430\u0437 \u0432 \u043e\u0447\u0435\u0440\u0435\u0434\u0438 \u043d\u0430 \u043f\u0440\u0438\u0433\u043e\u0442\u043e\u0432\u043b\u0435\u043d\u0438\u0435"}),e.success&&Object(j.jsx)("p",{className:"text text_type_main-default text_color_inactive pb-15",children:"\u0414\u043e\u0436\u0434\u0438\u0442\u0435\u0441\u044c \u0433\u043e\u0442\u043e\u0432\u043d\u043e\u0441\u0442\u0438 \u043d\u0430 \u043e\u0440\u0431\u0438\u0442\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0442\u0430\u043d\u0446\u0438\u0438"})]})}var M=n(17),B=n.n(M);function F(){var e=Object(s.c)((function(e){return e.ingredientsData.selectedIngredient}));return Object(j.jsxs)("div",{className:"".concat(B.a.container),children:[Object(j.jsx)("img",{width:"480",height:"240",alt:e.name,src:e&&e.image}),Object(j.jsx)("p",{className:"text text_type_main-medium pt-4 pb-8",children:e&&e.name}),Object(j.jsxs)("ul",{className:"".concat(B.a.list," pt-8"),children:[Object(j.jsxs)("li",{className:"".concat(B.a.listItem," text text_type_main-default text_color_inactive"),children:[Object(j.jsx)("span",{children:"\u041a\u0430\u043b\u043e\u0440\u0438\u0438,\u043a\u043a\u0430\u043b"}),e.calories]}),Object(j.jsxs)("li",{className:"".concat(B.a.listItem," text text_type_main-default text_color_inactive"),children:[Object(j.jsx)("span",{children:"\u0411\u0435\u043b\u043a\u0438, \u0433"}),e.proteins]}),Object(j.jsxs)("li",{className:"".concat(B.a.listItem," text text_type_main-default text_color_inactive"),children:[Object(j.jsx)("span",{children:"\u0416\u0438\u0440\u044b, \u0433"}),e.fat]}),Object(j.jsxs)("li",{className:"".concat(B.a.listItem," text text_type_main-default text_color_inactive"),children:[Object(j.jsx)("span",{children:"\u0423\u0433\u043b\u0435\u0432\u043e\u0434\u044b, \u0433"}),e.carbohydrates]})]})]})}var H=n(27),J=n.n(H),X=n(76),V=n.n(X);function Y(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.popupState.isOrderDetailsPopupOpen}));return Object(j.jsx)("div",{onClick:function(){e(t?{type:"CHANGE_ORDER_DETAILS_POPUP_STATE",payload:!1}:{type:"CHANGE_INGREDIENTS_POPUP_STATE",payload:!1}),e(t?{type:"DELETE_ORDER_DATA"}:{type:"DELETE_SELECTED_INGREDIENT"})},className:V.a.overlay})}function K(e){var t=e.children,n=e.title,a=void 0===n?"":n,i=Object(s.b)(),o=document.getElementById("react-modals"),l=Object(s.c)((function(e){return e.popupState.isOrderDetailsPopupOpen}));Object(c.useEffect)((function(){var e=function(e){"Escape"===e.key&&(i(l?{type:"CHANGE_ORDER_DETAILS_POPUP_STATE",payload:!1}:{type:"CHANGE_INGREDIENTS_POPUP_STATE",payload:!1}),i(l?{type:"DELETE_ORDER_DATA"}:{type:"DELETE_SELECTED_INGREDIENT"}))};return document.addEventListener("keyup",e),function(){document.removeEventListener("keyup",e)}}),[i,l]);return Object(r.createPortal)(Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)("div",{className:"".concat(J.a.container," pt-15 pr-10 pl-10 pb-15"),children:[Object(j.jsxs)("header",{className:J.a.header,children:[a&&Object(j.jsx)("h2",{className:"".concat(J.a.title," text text_type_main-large"),children:a}),Object(j.jsx)("button",{onClick:function(){i(l?{type:"CHANGE_ORDER_DETAILS_POPUP_STATE",payload:!1}:{type:"CHANGE_INGREDIENTS_POPUP_STATE",payload:!1}),i(l?{type:"DELETE_ORDER_DATA"}:{type:"DELETE_SELECTED_INGREDIENT"})},className:J.a.closeButton,children:Object(j.jsx)(u.CloseIcon,{type:"primary"})})]}),t]}),Object(j.jsx)(Y,{})]}),o)}var z=n(77),Z=n.n(z);function Q(){return Object(j.jsx)("div",{className:Z.a.loader})}var W="GET_INGREDIENTS",$="GET_INGREDIENTS_FAILED",ee="GET_INGREDIENTS_SUCCESS",te="SELECT_INGREDIENT",ne="DELETE_SELECTED_INGREDIENT",ce="ADD_INGREDIENT",ae="DELETE_INGREDIENT";function re(){var e=Object(s.c)((function(e){return e.orderData.orderDetails})),t=Object(s.c)((function(e){return e.popupState.isIngredientsPopupOpen})),n=Object(s.c)((function(e){return e.popupState.isOrderDetailsPopupOpen})),a=Object(s.c)((function(e){return e.ingredientsData.ingredientsRequest})),r=Object(s.b)();return Object(c.useEffect)((function(){r((function(e){e({type:W}),T.getIngredients().then((function(t){t&&e({type:ee,payload:t.data})})).catch((function(t){return e({type:$})}))}))}),[r]),Object(j.jsx)("div",{className:"".concat(l.a.app," pb-10"),children:a?Object(j.jsx)(Q,{}):Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(b,{}),Object(j.jsx)(L,{}),n&&Object(j.jsx)(K,{children:e?Object(j.jsx)(w,{}):Object(j.jsx)(Q,{})}),t&&Object(j.jsx)(K,{title:"\u0414\u0435\u0442\u0430\u043b\u0438 \u0438\u043d\u0433\u0440\u0435\u0434\u0438\u0435\u043d\u0442\u043e\u0432",children:Object(j.jsx)(F,{})})]})})}var ie=n(23),se=n(78),oe={ingredients:[],selectedIngredient:null,chosenIngredients:[],ingredientsRequest:!1,ingredientsFailed:!1},le={orderDetails:null,orderRequest:!1,orderFailed:!1},de="CHANGE_ORDER_DETAILS_POPUP_STATE",ue="CHANGE_INGREDIENTS_POPUP_STATE",_e={isOrderDetailsPopupOpen:!1,isIngredientsPopupOpen:!1},pe=Object(ie.b)({ingredientsData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case $:return Object(m.a)(Object(m.a)({},e),{},{ingredientsRequest:!1,ingredientsFailed:!0});case ee:return Object(m.a)(Object(m.a)({},e),{},{ingredientsRequest:!1,ingredients:t.payload});case W:return Object(m.a)(Object(m.a)({},e),{},{ingredientsRequest:!0,ingredientsFailed:!1});case te:return Object(m.a)(Object(m.a)({},e),{},{selectedIngredient:t.payload});case ne:return Object(m.a)(Object(m.a)({},e),{},{selectedIngredient:null});case ce:case ae:return Object(m.a)(Object(m.a)({},e),{},{chosenIngredients:t.payload});default:return e}},orderData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:le,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case I:return Object(m.a)(Object(m.a)({},e),{},{orderRequest:!0,orderFailed:!1});case R:return Object(m.a)(Object(m.a)({},e),{},{orderRequest:!1,orderFailed:!0});case S:return Object(m.a)(Object(m.a)({},e),{},{orderRequest:!1,orderDetails:t.payload});case C:return Object(m.a)(Object(m.a)({},e),{},{orderDetails:null});default:return e}},popupState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_e,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case de:return Object(m.a)(Object(m.a)({},e),{},{isOrderDetailsPopupOpen:t.payload});case ue:return Object(m.a)(Object(m.a)({},e),{},{isIngredientsPopupOpen:t.payload});default:return e}}}),je=("object"===typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):ie.c)(Object(ie.a)(se.a)),be=Object(ie.d)(pe,je);i.a.render(Object(j.jsx)(a.a.StrictMode,{children:Object(j.jsx)(d.a,{children:Object(j.jsx)(s.a,{store:be,children:Object(j.jsx)(re,{})})})}),document.getElementById("root"))},17:function(e,t,n){e.exports={container:"ingredient-details_container__1ZFLd",list:"ingredient-details_list__2nkKo",listItem:"ingredient-details_listItem__go-FH",title:"ingredient-details_title__nbDdr",header:"ingredient-details_header__2COJg",closeButton:"ingredient-details_closeButton__2YrT1"}},24:function(e,t,n){e.exports={list:"burger-constructor_list__I6ezH",constructor_container:"burger-constructor_constructor_container__3nAJ9",list_item:"burger-constructor_list_item__Zndc0",button_container:"burger-constructor_button_container__1r4sm"}},27:function(e,t,n){e.exports={container:"modal_container__3Uihb",title:"modal_title__MEoQp",header:"modal_header__3fbro",closeButton:"modal_closeButton__3qeWl"}},31:function(e,t,n){e.exports={title:"order-details_title__2JbNf",text:"order-details_text__3PxFh",container:"order-details_container__3KS0F",header:"order-details_header__G-UoV",closeButton:"order-details_closeButton__LegxB"}},51:function(e,t,n){e.exports={main:"main_main__dD72x",main_container:"main_main_container__2Egw-"}},73:function(e,t,n){e.exports={app:"app_app__WJwAR"}},76:function(e,t,n){e.exports={overlay:"modal-overlay_overlay__1J6KR"}},77:function(e,t,n){e.exports={loader:"loader_loader__qnhLB",rotate:"loader_rotate__jeH32"}}},[[167,1,2]]]);
//# sourceMappingURL=main.824d72b3.chunk.js.map